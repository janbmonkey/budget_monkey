version: "3.7"

services:

  bmfrontend:
    build: bmfrontend/.
    container_name: monkeyfrontend
    ports:
      - 3005:3004
    environment: 
      REACT_APP_SERVER_URL: http://localhost:8082
    command: yarn start
    tty: true
    restart: always
    networks: 
      - frontend
    depends_on: 
      - bmbackend

  bmbackend:
    build: bmbackend/.
    container_name: monkeybackend
    ports:
      - 8082:8081
    networks: 
      - bmonkey-net
    tty: true
    restart: always
    environment: 
      SPRING_DATASOURCE_URL: jdbc:mysql://db/test_db
      SPRING_DATASOURCE_USERNAME: dbuser
      SPRING_DATASOURCE_PASSWORD: userpass
    depends_on: 
      - db
    networks:
      - frontend
      - backend


  # db:
  #   image: postgres:13.1
  #   ports:
  #     - 5432:5432
  #   expose: 
  #     - 5432
  #   environment:
  #     - POSTGRES_USER=postgres
  #     - POSTGRES_PASSWORD=pass
  #     - POSTGRES_DB=mydb
  #   volumes:
  #     - type: bind
  #       source: $HOME/Desktop/BudgetBadger/BMdata.sql
  #       target: /data/BMdata.sql

  db:
    image: mysql
    container_name: monkeydb
    restart: always
    ports:
      - "3306:3306"
    networks:
      - backend
    environment:
      MYSQL_DATABASE: test_db
      MYSQL_USER: dbuser
      MYSQL_PASSWORD: userpass
      MYSQL_ROOT_PASSWORD: root
    volumes:
      - type: bind
        source: $HOME/Desktop/MySQL-Snippets/school.sql
        target: /data/school.sql

networks:
  backend:
  frontend:   
    